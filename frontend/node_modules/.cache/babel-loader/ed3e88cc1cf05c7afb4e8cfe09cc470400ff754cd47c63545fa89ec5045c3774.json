{"ast":null,"code":"import React,{useState}from'react';import{Link}from'react-router-dom';import{useCart}from'../utils/CartContext';import'../assets/ProductCard.css';// ⬅️ Thêm import này\nimport{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ProductCard(_ref){var _ref2,_product$category$nam,_product$category,_product$category2;let{product}=_ref;const{addToCart}=useCart();const[isAdding,setIsAdding]=useState(false);const[showSuccess,setShowSuccess]=useState(false);const[imageError,setImageError]=useState(false);// normalize category to a string\nconst categoryName=typeof product.category==='string'?product.category:(_ref2=(_product$category$nam=(_product$category=product.category)===null||_product$category===void 0?void 0:_product$category.name)!==null&&_product$category$nam!==void 0?_product$category$nam:(_product$category2=product.category)===null||_product$category2===void 0?void 0:_product$category2.title)!==null&&_ref2!==void 0?_ref2:'';const defaultImage='/default-product.png';const imgSrc=product.image||product.image_url||'/default-product.png';const handleAddToCart=e=>{e.preventDefault();e.stopPropagation();setIsAdding(true);addToCart(product,1);setShowSuccess(true);setTimeout(()=>{setIsAdding(false);setShowSuccess(false);},1500);};const handleImageError=()=>{setImageError(true);};return/*#__PURE__*/_jsx(\"article\",{className:\"product-card\",children:/*#__PURE__*/_jsxs(Link,{to:\"/product/\".concat(product.id),className:\"product-link\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"product-thumb\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"product-image\",children:/*#__PURE__*/_jsx(\"img\",{src:imageError?defaultImage:imgSrc,alt:product.name||'Product image',loading:\"lazy\",onError:handleImageError})}),/*#__PURE__*/_jsx(\"div\",{className:\"product-overlay\",children:/*#__PURE__*/_jsx(\"button\",{className:\"add-to-cart-btn \".concat(isAdding?'adding':'',\" \").concat(showSuccess?'success':''),onClick:handleAddToCart,disabled:isAdding,\"aria-label\":\"Th\\xEAm v\\xE0o gi\\u1ECF h\\xE0ng\",children:showSuccess?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"cart-icon\",children:\"\\u2713\"}),/*#__PURE__*/_jsx(\"span\",{className:\"cart-text\",children:\"\\u0110\\xE3 th\\xEAm\"})]}):isAdding?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"cart-icon\",children:\"...\"}),/*#__PURE__*/_jsx(\"span\",{className:\"cart-text\",children:\"\\u0110ang th\\xEAm...\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"span\",{className:\"cart-icon\",children:\"+\"}),/*#__PURE__*/_jsx(\"span\",{className:\"cart-text\",children:\"Th\\xEAm v\\xE0o gi\\u1ECF\"})]})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"product-body\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"product-name\",children:product.name}),categoryName&&/*#__PURE__*/_jsx(\"div\",{className:\"product-category\",children:categoryName}),((_ref3,_ref4,_product$rating_avg,_ref5,_ref6,_product$rating_count,_product$reviews)=>{const avg=(_ref3=(_ref4=(_product$rating_avg=product.rating_avg)!==null&&_product$rating_avg!==void 0?_product$rating_avg:product.average_rating)!==null&&_ref4!==void 0?_ref4:product.rating)!==null&&_ref3!==void 0?_ref3:null;const cnt=(_ref5=(_ref6=(_product$rating_count=product.rating_count)!==null&&_product$rating_count!==void 0?_product$rating_count:product.reviews_count)!==null&&_ref6!==void 0?_ref6:(_product$reviews=product.reviews)===null||_product$reviews===void 0?void 0:_product$reviews.length)!==null&&_ref5!==void 0?_ref5:null;const hasAny=typeof cnt==='number'?cnt>0:avg!==null;return/*#__PURE__*/_jsxs(\"div\",{className:\"product-meta-row\",style:{display:'flex',alignItems:'center',justifyContent:'space-between',marginTop:6},children:[/*#__PURE__*/_jsx(\"div\",{className:\"product-price\",children:product.price?\"\".concat(Number(product.price).toLocaleString('vi-VN'),\"\\u20AB\"):'Liên hệ'}),hasAny?/*#__PURE__*/_jsxs(\"div\",{className:\"product-avg\",title:\"\".concat(Number(avg||0).toFixed(1),\" sao\"),style:{display:'inline-flex',alignItems:'center',gap:4,color:'#f59e0b'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontSize:13,lineHeight:1,color:'inherit'},children:Number(avg||0).toFixed(1)}),/*#__PURE__*/_jsx(\"svg\",{width:\"14\",height:\"14\",viewBox:\"0 0 24 24\",fill:\"#f59e0b\",stroke:\"#f59e0b\",strokeWidth:\"2\",\"aria-hidden\":\"true\",style:{display:'block'},children:/*#__PURE__*/_jsx(\"path\",{d:\"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z\"})})]}):/*#__PURE__*/_jsx(\"span\",{})]});})()]})]})});}","map":{"version":3,"names":["React","useState","Link","useCart","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","ProductCard","_ref","_ref2","_product$category$nam","_product$category","_product$category2","product","addToCart","isAdding","setIsAdding","showSuccess","setShowSuccess","imageError","setImageError","categoryName","category","name","title","defaultImage","imgSrc","image","image_url","handleAddToCart","e","preventDefault","stopPropagation","setTimeout","handleImageError","className","children","to","concat","id","src","alt","loading","onError","onClick","disabled","_ref3","_ref4","_product$rating_avg","_ref5","_ref6","_product$rating_count","_product$reviews","avg","rating_avg","average_rating","rating","cnt","rating_count","reviews_count","reviews","length","hasAny","style","display","alignItems","justifyContent","marginTop","price","Number","toLocaleString","toFixed","gap","color","fontSize","lineHeight","width","height","viewBox","fill","stroke","strokeWidth","d"],"sources":["C:/VIET/PBL6/main/frontend/src/components/ProductCard.jsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\nimport { useCart } from '../utils/CartContext';\nimport '../assets/ProductCard.css';  // ⬅️ Thêm import này\n\nexport default function ProductCard({ product }) {\n  const { addToCart } = useCart();\n  const [isAdding, setIsAdding] = useState(false);\n  const [showSuccess, setShowSuccess] = useState(false);\n  const [imageError, setImageError] = useState(false);\n\n  // normalize category to a string\n  const categoryName =\n    typeof product.category === 'string'\n      ? product.category\n      : product.category?.name ?? product.category?.title ?? '';\n\n  const defaultImage = '/default-product.png';\n  const imgSrc = product.image || product.image_url || '/default-product.png';\n\n  const handleAddToCart = (e) => {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    setIsAdding(true);\n    addToCart(product, 1);\n    \n    setShowSuccess(true);\n    setTimeout(() => {\n      setIsAdding(false);\n      setShowSuccess(false);\n    }, 1500);\n  };\n\n  const handleImageError = () => {\n    setImageError(true);\n  };\n\n  return (\n    <article className=\"product-card\">\n      <Link to={`/product/${product.id}`} className=\"product-link\">\n        <div className=\"product-thumb\">\n          <div className=\"product-image\">\n            <img \n              src={imageError ? defaultImage : imgSrc} \n              alt={product.name || 'Product image'}\n              loading=\"lazy\"\n              onError={handleImageError}\n            />\n          </div>\n          <div className=\"product-overlay\">\n            <button\n              className={`add-to-cart-btn ${isAdding ? 'adding' : ''} ${showSuccess ? 'success' : ''}`}\n              onClick={handleAddToCart}\n              disabled={isAdding}\n              aria-label=\"Thêm vào giỏ hàng\"\n            >\n              {showSuccess ? (\n                <>\n                  <span className=\"cart-icon\">✓</span>\n                  <span className=\"cart-text\">Đã thêm</span>\n                </>\n              ) : isAdding ? (\n                <>\n                  <span className=\"cart-icon\">...</span>\n                  <span className=\"cart-text\">Đang thêm...</span>\n                </>\n              ) : (\n                <>\n                  <span className=\"cart-icon\">+</span>\n                  <span className=\"cart-text\">Thêm vào giỏ</span>\n                </>\n              )}\n            </button>\n          </div>\n        </div>\n\n        <div className=\"product-body\">\n          <h3 className=\"product-name\">{product.name}</h3>\n          {categoryName && <div className=\"product-category\">{categoryName}</div>}\n\n          {(() => {\n            const avg =\n              product.rating_avg ??\n              product.average_rating ??\n              product.rating ?? null;\n            const cnt =\n              product.rating_count ??\n              product.reviews_count ??\n              product.reviews?.length ??\n              null;\n            const hasAny = typeof cnt === 'number' ? cnt > 0 : avg !== null;\n\n            return (\n              <div\n                className=\"product-meta-row\"\n                style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginTop: 6 }}\n              >\n                <div className=\"product-price\">\n                  {product.price ? `${Number(product.price).toLocaleString('vi-VN')}₫` : 'Liên hệ'}\n                </div>\n\n                {hasAny ? (\n                  <div\n                    className=\"product-avg\"\n                    title={`${Number(avg || 0).toFixed(1)} sao`}\n                    style={{ display: 'inline-flex', alignItems: 'center', gap: 4, color: '#f59e0b' }}\n                  >\n                    <span style={{ fontSize: 13, lineHeight: 1, color: 'inherit' }}>\n                      {Number(avg || 0).toFixed(1)}\n                    </span>\n                    <svg\n                      width=\"14\"\n                      height=\"14\"\n                      viewBox=\"0 0 24 24\"\n                      fill=\"#f59e0b\"\n                      stroke=\"#f59e0b\"\n                      strokeWidth=\"2\"\n                      aria-hidden=\"true\"\n                      style={{ display: 'block' }}\n                    >\n                      <path d=\"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z\"/>\n                    </svg>\n                  </div>\n                ) : <span /> }\n              </div>\n            );\n          })()}\n        </div>\n      </Link>\n    </article>\n  );\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}