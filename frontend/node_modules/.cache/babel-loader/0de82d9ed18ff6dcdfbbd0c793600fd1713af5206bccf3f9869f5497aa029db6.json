{"ast":null,"code":"import _objectSpread from\"C:/VIET/PBL6/main/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useMemo}from'react';import{useParams,useNavigate}from'react-router-dom';import ProductGrid from'../components/ProductGrid';import ImageSearchUpload from'../components/ImageSearchUpload';import Loading from'../components/Loading';import'../assets/CategoryPage.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function CategoryPage(){var _ref,_ref2,_params$slug;const params=useParams();const rawCategoryParam=(_ref=(_ref2=(_params$slug=params.slug)!==null&&_params$slug!==void 0?_params$slug:params.categoryName)!==null&&_ref2!==void 0?_ref2:params.category)!==null&&_ref!==void 0?_ref:'';const slugFromUrl=rawCategoryParam?decodeURIComponent(rawCategoryParam):'';const navigate=useNavigate();// Data\nconst[categories,setCategories]=useState([]);const[products,setProducts]=useState([]);// UI/Filter state\nconst[query,setQuery]=useState('');const[priceRange,setPriceRange]=useState({min:'',max:''});const[sortBy,setSortBy]=useState('relevance');const[currentPage,setCurrentPage]=useState(1);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[showFilters,setShowFilters]=useState(false);const[imageResults,setImageResults]=useState(null);// danh s√°ch tr·∫£ v·ªÅ t·ª´ search ·∫£nh\nuseEffect(()=>{let cancelled=false;async function load(){setLoading(true);setError(null);try{var _cRes$results,_pRes$results;const[cRes,pRes]=await Promise.all([fetch('http://localhost:8000/api/categories/').then(r=>r.json()),fetch('http://localhost:8000/api/products/').then(r=>r.json())]);if(cancelled)return;const cats=Array.isArray(cRes)?cRes:(_cRes$results=cRes.results)!==null&&_cRes$results!==void 0?_cRes$results:[];const prods=Array.isArray(pRes)?pRes:(_pRes$results=pRes.results)!==null&&_pRes$results!==void 0?_pRes$results:[];setCategories(cats);setProducts(prods);}catch(err){if(cancelled)return;console.error('CategoryPage load error',err);setError('Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu. Vui l√≤ng th·ª≠ l·∫°i sau.');}finally{if(!cancelled)setLoading(false);}}load();return()=>{cancelled=true;};},[]);// Determine active category\nconst activeCategoryObj=useMemo(()=>{var _categories$find;if(!slugFromUrl)return null;return(_categories$find=categories.find(c=>{var _c$slug,_c$name,_c$id;const slug=String((_c$slug=c===null||c===void 0?void 0:c.slug)!==null&&_c$slug!==void 0?_c$slug:'').toLowerCase();const name=String((_c$name=c===null||c===void 0?void 0:c.name)!==null&&_c$name!==void 0?_c$name:'').toLowerCase();const id=String((_c$id=c===null||c===void 0?void 0:c.id)!==null&&_c$id!==void 0?_c$id:'').toLowerCase();const param=String(rawCategoryParam!==null&&rawCategoryParam!==void 0?rawCategoryParam:'').toLowerCase();return slug===param||name===param||id===param;}))!==null&&_categories$find!==void 0?_categories$find:null;},[categories,rawCategoryParam,slugFromUrl]);// Product matching\nfunction productMatchesCategory(prod,identifier){var _ref3,_pc$id,_ref4,_pc$name,_pc$slug;if(!identifier)return true;const idNorm=String(identifier).toLowerCase();const pc=prod.category;if(pc==null)return false;if(typeof pc==='string'||typeof pc==='number'){const v=String(pc).toLowerCase();return v===idNorm||v.includes(idNorm)||idNorm.includes(v);}const pid=String((_ref3=(_pc$id=pc.id)!==null&&_pc$id!==void 0?_pc$id:pc.pk)!==null&&_ref3!==void 0?_ref3:'').toLowerCase();const pname=String((_ref4=(_pc$name=pc.name)!==null&&_pc$name!==void 0?_pc$name:pc.title)!==null&&_ref4!==void 0?_ref4:'').toLowerCase();const pslug=String((_pc$slug=pc.slug)!==null&&_pc$slug!==void 0?_pc$slug:'').toLowerCase();return pid===idNorm||pname===idNorm||pslug===idNorm||pname.includes(idNorm)||pslug.includes(idNorm);}// Filtered products\nconst filteredProducts=useMemo(()=>{var _ref5,_activeCategoryObj$sl;const activeIdentifier=activeCategoryObj?(_ref5=(_activeCategoryObj$sl=activeCategoryObj.slug)!==null&&_activeCategoryObj$sl!==void 0?_activeCategoryObj$sl:activeCategoryObj.name)!==null&&_ref5!==void 0?_ref5:String(activeCategoryObj.id):slugFromUrl||'';const q=(query||'').trim().toLowerCase();const list=(products||[]).filter(product=>{var _product$price;if(activeIdentifier&&!productMatchesCategory(product,activeIdentifier))return false;if(q){var _product$name,_product$description;const name=String((_product$name=product.name)!==null&&_product$name!==void 0?_product$name:'').toLowerCase();const desc=String((_product$description=product.description)!==null&&_product$description!==void 0?_product$description:'').toLowerCase();if(!name.includes(q)&&!desc.includes(q))return false;}const price=Number((_product$price=product.price)!==null&&_product$price!==void 0?_product$price:0);if(priceRange.min&&price<Number(priceRange.min))return false;if(priceRange.max&&price>Number(priceRange.max))return false;return true;});switch(sortBy){case'price-low':list.sort((a,b)=>(Number(a.price)||0)-(Number(b.price)||0));break;case'price-high':list.sort((a,b)=>(Number(b.price)||0)-(Number(a.price)||0));break;case'name':list.sort((a,b)=>String(a.name).localeCompare(String(b.name)));break;case'newest':list.sort((a,b)=>(b.id||0)-(a.id||0));break;default:break;}return list;},[products,activeCategoryObj,slugFromUrl,query,priceRange,sortBy]);// Header count d√πng effectiveFiltered thay v√¨ filteredProducts\nconst effectiveFiltered=useMemo(()=>{if(imageResults)return imageResults;return filteredProducts;},[imageResults,filteredProducts]);const ITEMS_PER_PAGE=24;const totalPages=Math.max(1,Math.ceil(effectiveFiltered.length/ITEMS_PER_PAGE));useEffect(()=>{if(currentPage>totalPages)setCurrentPage(totalPages);},[currentPage,totalPages]);const paginatedProducts=useMemo(()=>{const start=(currentPage-1)*ITEMS_PER_PAGE;return effectiveFiltered.slice(start,start+ITEMS_PER_PAGE);},[effectiveFiltered,currentPage]);// Handlers\nconst handleCategoryChange=catSlugOrName=>{var _found$slug;if(!catSlugOrName){navigate('/products');return;}const found=categories.find(c=>String(c.slug)===String(catSlugOrName)||String(c.name)===String(catSlugOrName)||String(c.id)===String(catSlugOrName));const toSlug=found?(_found$slug=found.slug)!==null&&_found$slug!==void 0?_found$slug:found.name:catSlugOrName;navigate(\"/category/\".concat(encodeURIComponent(toSlug)));setShowFilters(false);};const handleClearFilters=()=>{setQuery('');setPriceRange({min:'',max:''});setSortBy('relevance');setCurrentPage(1);setImageResults(null);// tho√°t ch·∫ø ƒë·ªô t√¨m b·∫±ng ·∫£nh\n};// replace handleImageFileChange usage b·∫±ng ImageSearchUpload\nif(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"category-page\",children:/*#__PURE__*/_jsx(Loading,{message:\"\\u0110ang t\\u1EA3i s\\u1EA3n ph\\u1EA9m...\"})});}if(error){return/*#__PURE__*/_jsx(\"div\",{className:\"category-page\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"error-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"error-icon\",children:\"\\u26A0\\uFE0F\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"C\\xF3 l\\u1ED7i x\\u1EA3y ra\"}),/*#__PURE__*/_jsx(\"p\",{children:error}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.location.reload(),className:\"btn btn-primary\",children:\"Th\\u1EED l\\u1EA1i\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"category-page\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"category-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"category-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"breadcrumb\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"/\",children:\"Trang ch\\u1EE7\"}),/*#__PURE__*/_jsx(\"span\",{className:\"breadcrumb-separator\",children:\"/\"}),/*#__PURE__*/_jsx(\"span\",{className:\"breadcrumb-current\",children:(activeCategoryObj===null||activeCategoryObj===void 0?void 0:activeCategoryObj.name)||slugFromUrl||'T·∫•t c·∫£ s·∫£n ph·∫©m'})]}),/*#__PURE__*/_jsx(\"h1\",{className:\"category-title\",children:(activeCategoryObj===null||activeCategoryObj===void 0?void 0:activeCategoryObj.name)||slugFromUrl||'T·∫•t c·∫£ s·∫£n ph·∫©m'}),/*#__PURE__*/_jsxs(\"p\",{className:\"category-subtitle\",children:[effectiveFiltered.length,\" s\\u1EA3n ph\\u1EA9m\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"category-content\",children:[/*#__PURE__*/_jsxs(\"aside\",{className:\"filters-sidebar \".concat(showFilters?'mobile-open':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"filters-header\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"B\\u1ED9 l\\u1ECDc\"}),/*#__PURE__*/_jsx(\"button\",{className:\"filters-close\",onClick:()=>setShowFilters(false),children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"filter-label\",children:\"T\\xECm ki\\u1EBFm\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"filter-input\",placeholder:\"T\\xECm s\\u1EA3n ph\\u1EA9m...\",value:query,onChange:e=>setQuery(e.target.value)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"filter-label\",children:\"Danh m\\u1EE5c\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"category-list\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"category-item \".concat(!slugFromUrl?'active':''),onClick:()=>handleCategoryChange(''),children:\"T\\u1EA5t c\\u1EA3\"}),categories.map(cat=>/*#__PURE__*/_jsx(\"button\",{className:\"category-item \".concat((activeCategoryObj===null||activeCategoryObj===void 0?void 0:activeCategoryObj.id)===cat.id?'active':''),onClick:()=>handleCategoryChange(cat.slug||cat.name),children:cat.name},cat.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"filter-label\",children:\"Kho\\u1EA3ng gi\\xE1\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"price-range-inputs\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"filter-input\",placeholder:\"T\\u1EEB\",value:priceRange.min,onChange:e=>setPriceRange(prev=>_objectSpread(_objectSpread({},prev),{},{min:e.target.value}))}),/*#__PURE__*/_jsx(\"span\",{className:\"price-separator\",children:\"-\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",className:\"filter-input\",placeholder:\"\\u0110\\u1EBFn\",value:priceRange.max,onChange:e=>setPriceRange(prev=>_objectSpread(_objectSpread({},prev),{},{max:e.target.value}))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-section\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"filter-label\",children:\"S\\u1EAFp x\\u1EBFp\"}),/*#__PURE__*/_jsxs(\"select\",{className:\"filter-select\",value:sortBy,onChange:e=>setSortBy(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"relevance\",children:\"Li\\xEAn quan\"}),/*#__PURE__*/_jsx(\"option\",{value:\"price-low\",children:\"Gi\\xE1: Th\\u1EA5p \\u0111\\u1EBFn cao\"}),/*#__PURE__*/_jsx(\"option\",{value:\"price-high\",children:\"Gi\\xE1: Cao \\u0111\\u1EBFn th\\u1EA5p\"}),/*#__PURE__*/_jsx(\"option\",{value:\"name\",children:\"T\\xEAn: A-Z\"}),/*#__PURE__*/_jsx(\"option\",{value:\"newest\",children:\"M\\u1EDBi nh\\u1EA5t\"})]})]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-clear-filters\",onClick:handleClearFilters,children:\"X\\xF3a b\\u1ED9 l\\u1ECDc\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"products-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"products-toolbar\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"btn-toggle-filters\",onClick:()=>setShowFilters(!showFilters),children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\uD83D\\uDD0D\"}),\"B\\u1ED9 l\\u1ECDc\"]}),/*#__PURE__*/_jsx(ImageSearchUpload,{k:48,onStart:()=>setLoading(true),onFinish:()=>setLoading(false),onResults:mapped=>{setImageResults(mapped);setCurrentPage(1);setShowFilters(false);},onError:msg=>setError(msg)}),imageResults&&/*#__PURE__*/_jsx(\"button\",{className:\"btn\",style:{marginLeft:8},onClick:()=>setImageResults(null),children:\"H\\u1EE7y k\\u1EBFt qu\\u1EA3 \\u1EA3nh\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"results-info\",children:[\"Hi\\u1EC3n th\\u1ECB \",paginatedProducts.length,\" / \",effectiveFiltered.length,\" s\\u1EA3n ph\\u1EA9m\",imageResults&&/*#__PURE__*/_jsx(\"span\",{style:{marginLeft:8,color:'#888'},children:\"(k\\u1EBFt qu\\u1EA3 t\\u1EEB \\u1EA3nh)\"})]})]}),effectiveFiltered.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"empty-icon\",children:\"\\uD83D\\uDCE6\"}),/*#__PURE__*/_jsx(\"h2\",{children:\"Kh\\xF4ng t\\xECm th\\u1EA5y s\\u1EA3n ph\\u1EA9m\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Vui l\\xF2ng th\\u1EED \\u0111i\\u1EC1u ch\\u1EC9nh b\\u1ED9 l\\u1ECDc ho\\u1EB7c t\\xECm ki\\u1EBFm kh\\xE1c\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:handleClearFilters,children:\"X\\xF3a b\\u1ED9 l\\u1ECDc\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(ProductGrid,{products:paginatedProducts}),totalPages>1&&/*#__PURE__*/_jsxs(\"div\",{className:\"pagination\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"pagination-btn\",onClick:()=>setCurrentPage(p=>Math.max(1,p-1)),disabled:currentPage===1,children:\"\\u2190 Tr\\u01B0\\u1EDBc\"}),/*#__PURE__*/_jsx(\"div\",{className:\"pagination-pages\",children:Array.from({length:totalPages},(_,i)=>i+1).map(page=>/*#__PURE__*/_jsx(\"button\",{className:\"pagination-page \".concat(currentPage===page?'active':''),onClick:()=>setCurrentPage(page),children:page},page))}),/*#__PURE__*/_jsx(\"button\",{className:\"pagination-btn\",onClick:()=>setCurrentPage(p=>Math.min(totalPages,p+1)),disabled:currentPage===totalPages,children:\"Sau \\u2192\"})]})]})]})]})]}),showFilters&&/*#__PURE__*/_jsx(\"div\",{className:\"filters-overlay-backdrop\",onClick:()=>setShowFilters(false)})]});}","map":{"version":3,"names":["React","useState","useEffect","useMemo","useParams","useNavigate","ProductGrid","ImageSearchUpload","Loading","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","CategoryPage","_ref","_ref2","_params$slug","params","rawCategoryParam","slug","categoryName","category","slugFromUrl","decodeURIComponent","navigate","categories","setCategories","products","setProducts","query","setQuery","priceRange","setPriceRange","min","max","sortBy","setSortBy","currentPage","setCurrentPage","loading","setLoading","error","setError","showFilters","setShowFilters","imageResults","setImageResults","cancelled","load","_cRes$results","_pRes$results","cRes","pRes","Promise","all","fetch","then","r","json","cats","Array","isArray","results","prods","err","console","activeCategoryObj","_categories$find","find","c","_c$slug","_c$name","_c$id","String","toLowerCase","name","id","param","productMatchesCategory","prod","identifier","_ref3","_pc$id","_ref4","_pc$name","_pc$slug","idNorm","pc","v","includes","pid","pk","pname","title","pslug","filteredProducts","_ref5","_activeCategoryObj$sl","activeIdentifier","q","trim","list","filter","product","_product$price","_product$name","_product$description","desc","description","price","Number","sort","a","b","localeCompare","effectiveFiltered","ITEMS_PER_PAGE","totalPages","Math","ceil","length","paginatedProducts","start","slice","handleCategoryChange","catSlugOrName","_found$slug","found","toSlug","concat","encodeURIComponent","handleClearFilters","className","children","message","onClick","window","location","reload","href","type","placeholder","value","onChange","e","target","map","cat","prev","_objectSpread","k","onStart","onFinish","onResults","mapped","onError","msg","style","marginLeft","color","p","disabled","from","_","i","page"],"sources":["C:/VIET/PBL6/main/frontend/src/pages/CategoryPage.jsx"],"sourcesContent":["import React, { useState, useEffect, useMemo } from 'react';\r\nimport { useParams, useNavigate } from 'react-router-dom';\r\nimport ProductGrid from '../components/ProductGrid';\r\nimport ImageSearchUpload from '../components/ImageSearchUpload';\r\nimport Loading from '../components/Loading';\r\nimport '../assets/CategoryPage.css';\r\n\r\nexport default function CategoryPage() {\r\n  const params = useParams();\r\n  const rawCategoryParam = params.slug ?? params.categoryName ?? params.category ?? '';\r\n  const slugFromUrl = rawCategoryParam ? decodeURIComponent(rawCategoryParam) : '';\r\n  const navigate = useNavigate();\r\n\r\n  // Data\r\n  const [categories, setCategories] = useState([]);\r\n  const [products, setProducts] = useState([]);\r\n\r\n  // UI/Filter state\r\n  const [query, setQuery] = useState('');\r\n  const [priceRange, setPriceRange] = useState({ min: '', max: '' });\r\n  const [sortBy, setSortBy] = useState('relevance');\r\n  const [currentPage, setCurrentPage] = useState(1);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [showFilters, setShowFilters] = useState(false);\r\n  const [imageResults, setImageResults] = useState(null); // danh s√°ch tr·∫£ v·ªÅ t·ª´ search ·∫£nh\r\n\r\n  useEffect(() => {\r\n    let cancelled = false;\r\n    async function load() {\r\n      setLoading(true);\r\n      setError(null);\r\n      try {\r\n        const [cRes, pRes] = await Promise.all([\r\n          fetch('http://localhost:8000/api/categories/').then(r => r.json()),\r\n          fetch('http://localhost:8000/api/products/').then(r => r.json())\r\n        ]);\r\n        if (cancelled) return;\r\n        \r\n        const cats = Array.isArray(cRes) ? cRes : (cRes.results ?? []);\r\n        const prods = Array.isArray(pRes) ? pRes : (pRes.results ?? []);\r\n        \r\n        setCategories(cats);\r\n        setProducts(prods);\r\n      } catch (err) {\r\n        if (cancelled) return;\r\n        console.error('CategoryPage load error', err);\r\n        setError('Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu. Vui l√≤ng th·ª≠ l·∫°i sau.');\r\n      } finally {\r\n        if (!cancelled) setLoading(false);\r\n      }\r\n    }\r\n    load();\r\n    return () => { cancelled = true; };\r\n  }, []);\r\n\r\n  // Determine active category\r\n  const activeCategoryObj = useMemo(() => {\r\n    if (!slugFromUrl) return null;\r\n    return categories.find(c => {\r\n      const slug = String(c?.slug ?? '').toLowerCase();\r\n      const name = String(c?.name ?? '').toLowerCase();\r\n      const id = String(c?.id ?? '').toLowerCase();\r\n      const param = String(rawCategoryParam ?? '').toLowerCase();\r\n      return slug === param || name === param || id === param;\r\n    }) ?? null;\r\n  }, [categories, rawCategoryParam, slugFromUrl]);\r\n\r\n  // Product matching\r\n  function productMatchesCategory(prod, identifier) {\r\n    if (!identifier) return true;\r\n    const idNorm = String(identifier).toLowerCase();\r\n    const pc = prod.category;\r\n    if (pc == null) return false;\r\n\r\n    if (typeof pc === 'string' || typeof pc === 'number') {\r\n      const v = String(pc).toLowerCase();\r\n      return v === idNorm || v.includes(idNorm) || idNorm.includes(v);\r\n    }\r\n\r\n    const pid = String(pc.id ?? pc.pk ?? '').toLowerCase();\r\n    const pname = String(pc.name ?? pc.title ?? '').toLowerCase();\r\n    const pslug = String(pc.slug ?? '').toLowerCase();\r\n\r\n    return pid === idNorm || pname === idNorm || pslug === idNorm || \r\n           pname.includes(idNorm) || pslug.includes(idNorm);\r\n  }\r\n\r\n  // Filtered products\r\n  const filteredProducts = useMemo(() => {\r\n    const activeIdentifier = activeCategoryObj \r\n      ? (activeCategoryObj.slug ?? activeCategoryObj.name ?? String(activeCategoryObj.id))\r\n      : (slugFromUrl || '');\r\n    const q = (query || '').trim().toLowerCase();\r\n\r\n    const list = (products || []).filter(product => {\r\n      if (activeIdentifier && !productMatchesCategory(product, activeIdentifier)) return false;\r\n      \r\n      if (q) {\r\n        const name = String(product.name ?? '').toLowerCase();\r\n        const desc = String(product.description ?? '').toLowerCase();\r\n        if (!name.includes(q) && !desc.includes(q)) return false;\r\n      }\r\n      \r\n      const price = Number(product.price ?? 0);\r\n      if (priceRange.min && price < Number(priceRange.min)) return false;\r\n      if (priceRange.max && price > Number(priceRange.max)) return false;\r\n      \r\n      return true;\r\n    });\r\n\r\n    switch (sortBy) {\r\n      case 'price-low':\r\n        list.sort((a, b) => (Number(a.price) || 0) - (Number(b.price) || 0));\r\n        break;\r\n      case 'price-high':\r\n        list.sort((a, b) => (Number(b.price) || 0) - (Number(a.price) || 0));\r\n        break;\r\n      case 'name':\r\n        list.sort((a, b) => String(a.name).localeCompare(String(b.name)));\r\n        break;\r\n      case 'newest':\r\n        list.sort((a, b) => (b.id || 0) - (a.id || 0));\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n\r\n    return list;\r\n  }, [products, activeCategoryObj, slugFromUrl, query, priceRange, sortBy]);\r\n\r\n  // Header count d√πng effectiveFiltered thay v√¨ filteredProducts\r\n  const effectiveFiltered = useMemo(() => {\r\n    if (imageResults) return imageResults;\r\n    return filteredProducts;\r\n  }, [imageResults, filteredProducts]);\r\n\r\n  const ITEMS_PER_PAGE = 24;\r\n  const totalPages = Math.max(1, Math.ceil(effectiveFiltered.length / ITEMS_PER_PAGE));\r\n  \r\n  useEffect(() => {\r\n    if (currentPage > totalPages) setCurrentPage(totalPages);\r\n  }, [currentPage, totalPages]);\r\n\r\n  const paginatedProducts = useMemo(() => {\r\n    const start = (currentPage - 1) * ITEMS_PER_PAGE;\r\n    return effectiveFiltered.slice(start, start + ITEMS_PER_PAGE);\r\n  }, [effectiveFiltered, currentPage]);\r\n\r\n  // Handlers\r\n  const handleCategoryChange = (catSlugOrName) => {\r\n    if (!catSlugOrName) {\r\n      navigate('/products');\r\n      return;\r\n    }\r\n    const found = categories.find(c => \r\n      String(c.slug) === String(catSlugOrName) || \r\n      String(c.name) === String(catSlugOrName) || \r\n      String(c.id) === String(catSlugOrName)\r\n    );\r\n    const toSlug = found ? (found.slug ?? found.name) : catSlugOrName;\r\n    navigate(`/category/${encodeURIComponent(toSlug)}`);\r\n    setShowFilters(false);\r\n  };\r\n\r\n  const handleClearFilters = () => {\r\n    setQuery('');\r\n    setPriceRange({ min: '', max: '' });\r\n    setSortBy('relevance');\r\n    setCurrentPage(1);\r\n    setImageResults(null); // tho√°t ch·∫ø ƒë·ªô t√¨m b·∫±ng ·∫£nh\r\n  };\r\n\r\n  // replace handleImageFileChange usage b·∫±ng ImageSearchUpload\r\n  if (loading) {\r\n    return (\r\n      <div className=\"category-page\">\r\n        <Loading message=\"ƒêang t·∫£i s·∫£n ph·∫©m...\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"category-page\">\r\n        <div className=\"error-container\">\r\n          <div className=\"error-icon\">‚ö†Ô∏è</div>\r\n          <h2>C√≥ l·ªói x·∫£y ra</h2>\r\n          <p>{error}</p>\r\n          <button onClick={() => window.location.reload()} className=\"btn btn-primary\">\r\n            Th·ª≠ l·∫°i\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"category-page\">\r\n      <div className=\"category-container\">\r\n        {/* Header */}\r\n        <div className=\"category-header\">\r\n          <div className=\"breadcrumb\">\r\n            <a href=\"/\">Trang ch·ªß</a>\r\n            <span className=\"breadcrumb-separator\">/</span>\r\n            <span className=\"breadcrumb-current\">\r\n              {activeCategoryObj?.name || slugFromUrl || 'T·∫•t c·∫£ s·∫£n ph·∫©m'}\r\n            </span>\r\n          </div>\r\n          \r\n          <h1 className=\"category-title\">\r\n            {activeCategoryObj?.name || slugFromUrl || 'T·∫•t c·∫£ s·∫£n ph·∫©m'}\r\n          </h1>\r\n          \r\n          <p className=\"category-subtitle\">\r\n            {effectiveFiltered.length} s·∫£n ph·∫©m\r\n          </p>\r\n        </div>\r\n\r\n        <div className=\"category-content\">\r\n          {/* Sidebar Filters */}\r\n          <aside className={`filters-sidebar ${showFilters ? 'mobile-open' : ''}`}>\r\n            <div className=\"filters-header\">\r\n              <h3>B·ªô l·ªçc</h3>\r\n              <button \r\n                className=\"filters-close\" \r\n                onClick={() => setShowFilters(false)}\r\n              >\r\n                ‚úï\r\n              </button>\r\n            </div>\r\n\r\n            {/* Search */}\r\n            <div className=\"filter-section\">\r\n              <label className=\"filter-label\">T√¨m ki·∫øm</label>\r\n              <input\r\n                type=\"text\"\r\n                className=\"filter-input\"\r\n                placeholder=\"T√¨m s·∫£n ph·∫©m...\"\r\n                value={query}\r\n                onChange={(e) => setQuery(e.target.value)}\r\n              />\r\n            </div>\r\n\r\n            {/* Categories */}\r\n            <div className=\"filter-section\">\r\n              <label className=\"filter-label\">Danh m·ª•c</label>\r\n              <div className=\"category-list\">\r\n                <button\r\n                  className={`category-item ${!slugFromUrl ? 'active' : ''}`}\r\n                  onClick={() => handleCategoryChange('')}\r\n                >\r\n                  T·∫•t c·∫£\r\n                </button>\r\n                {categories.map((cat) => (\r\n                  <button\r\n                    key={cat.id}\r\n                    className={`category-item ${\r\n                      activeCategoryObj?.id === cat.id ? 'active' : ''\r\n                    }`}\r\n                    onClick={() => handleCategoryChange(cat.slug || cat.name)}\r\n                  >\r\n                    {cat.name}\r\n                  </button>\r\n                ))}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Price Range */}\r\n            <div className=\"filter-section\">\r\n              <label className=\"filter-label\">Kho·∫£ng gi√°</label>\r\n              <div className=\"price-range-inputs\">\r\n                <input\r\n                  type=\"number\"\r\n                  className=\"filter-input\"\r\n                  placeholder=\"T·ª´\"\r\n                  value={priceRange.min}\r\n                  onChange={(e) => setPriceRange(prev => ({ ...prev, min: e.target.value }))}\r\n                />\r\n                <span className=\"price-separator\">-</span>\r\n                <input\r\n                  type=\"number\"\r\n                  className=\"filter-input\"\r\n                  placeholder=\"ƒê·∫øn\"\r\n                  value={priceRange.max}\r\n                  onChange={(e) => setPriceRange(prev => ({ ...prev, max: e.target.value }))}\r\n                />\r\n              </div>\r\n            </div>\r\n\r\n            {/* Sort */}\r\n            <div className=\"filter-section\">\r\n              <label className=\"filter-label\">S·∫Øp x·∫øp</label>\r\n              <select\r\n                className=\"filter-select\"\r\n                value={sortBy}\r\n                onChange={(e) => setSortBy(e.target.value)}\r\n              >\r\n                <option value=\"relevance\">Li√™n quan</option>\r\n                <option value=\"price-low\">Gi√°: Th·∫•p ƒë·∫øn cao</option>\r\n                <option value=\"price-high\">Gi√°: Cao ƒë·∫øn th·∫•p</option>\r\n                <option value=\"name\">T√™n: A-Z</option>\r\n                <option value=\"newest\">M·ªõi nh·∫•t</option>\r\n              </select>\r\n            </div>\r\n\r\n            {/* Clear Filters */}\r\n            <button className=\"btn-clear-filters\" onClick={handleClearFilters}>\r\n              X√≥a b·ªô l·ªçc\r\n            </button>\r\n          </aside>\r\n\r\n          {/* Products Section */}\r\n          <div className=\"products-section\">\r\n            {/* Toolbar */}\r\n            <div className=\"products-toolbar\">\r\n              <button\r\n                className=\"btn-toggle-filters\"\r\n                onClick={() => setShowFilters(!showFilters)}\r\n              >\r\n                <span>üîç</span>\r\n                B·ªô l·ªçc\r\n              </button>\r\n\r\n              <ImageSearchUpload\r\n                k={48}\r\n                onStart={() => setLoading(true)}\r\n                onFinish={() => setLoading(false)}\r\n                onResults={(mapped) => {\r\n                  setImageResults(mapped);\r\n                  setCurrentPage(1);\r\n                  setShowFilters(false);\r\n                }}\r\n                onError={(msg) => setError(msg)}\r\n              />\r\n\r\n              {imageResults && (\r\n                <button className=\"btn\" style={{ marginLeft: 8 }} onClick={() => setImageResults(null)}>\r\n                  H·ªßy k·∫øt qu·∫£ ·∫£nh\r\n                </button>\r\n              )}\r\n\r\n              <div className=\"results-info\">\r\n                Hi·ªÉn th·ªã {paginatedProducts.length} / {effectiveFiltered.length} s·∫£n ph·∫©m\r\n                {imageResults && <span style={{ marginLeft: 8, color: '#888' }}>(k·∫øt qu·∫£ t·ª´ ·∫£nh)</span>}\r\n              </div>\r\n            </div>\r\n\r\n            {/* Products Grid */}\r\n            {effectiveFiltered.length === 0 ? (\r\n              <div className=\"empty-state\">\r\n                <div className=\"empty-icon\">üì¶</div>\r\n                <h2>Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m</h2>\r\n                <p>Vui l√≤ng th·ª≠ ƒëi·ªÅu ch·ªânh b·ªô l·ªçc ho·∫∑c t√¨m ki·∫øm kh√°c</p>\r\n                <button className=\"btn btn-primary\" onClick={handleClearFilters}>\r\n                  X√≥a b·ªô l·ªçc\r\n                </button>\r\n              </div>\r\n            ) : (\r\n              <>\r\n                <ProductGrid products={paginatedProducts} />\r\n\r\n                {/* Pagination */}\r\n                {totalPages > 1 && (\r\n                  <div className=\"pagination\">\r\n                    <button\r\n                      className=\"pagination-btn\"\r\n                      onClick={() => setCurrentPage(p => Math.max(1, p - 1))}\r\n                      disabled={currentPage === 1}\r\n                    >\r\n                      ‚Üê Tr∆∞·ªõc\r\n                    </button>\r\n                    \r\n                    <div className=\"pagination-pages\">\r\n                      {Array.from({ length: totalPages }, (_, i) => i + 1).map(page => (\r\n                        <button\r\n                          key={page}\r\n                          className={`pagination-page ${currentPage === page ? 'active' : ''}`}\r\n                          onClick={() => setCurrentPage(page)}\r\n                        >\r\n                          {page}\r\n                        </button>\r\n                      ))}\r\n                    </div>\r\n\r\n                    <button\r\n                      className=\"pagination-btn\"\r\n                      onClick={() => setCurrentPage(p => Math.min(totalPages, p + 1))}\r\n                      disabled={currentPage === totalPages}\r\n                    >\r\n                      Sau ‚Üí\r\n                    </button>\r\n                  </div>\r\n                )}\r\n              </>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Mobile Overlay */}\r\n      {showFilters && (\r\n        <div \r\n          className=\"filters-overlay-backdrop\"\r\n          onClick={() => setShowFilters(false)}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}